[2024-07-26 11:33:55,503] INFO - prefect.clean_log_file | 
 <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <> 
[2024-07-26 11:33:55,503] INFO - prefect.clean_log_file | 
 <> Limpeza do arquivo de log local logs/logs__historic_materialize.txt realizada com sucesso.
[2024-07-26 11:33:55,506] INFO - prefect.TaskRunner | Task 'clean_log_file': Finished task run for task with final state: 'Success'
[2024-07-26 11:33:55,510] INFO - prefect.TaskRunner | Task 'run_dbt': Starting task run...
[2024-07-26 11:33:58,524] INFO - prefect.run_dbt | 
 <> Falha na transformação (DBT):  CompletedProcess(args=['dbt', 'run', '--vars', 'database: prefect_server', '--select', 'staging.historic_raw staging.historic_cleaned staging.historic_renamed staging.historic_transformed'], returncode=1, stdout='\x1b[0m14:33:56  Running with dbt=1.8.4\n\x1b[0m14:33:56  Registered adapter: postgres=1.8.2\n\x1b[0m14:33:56  [\x1b[33mWARNING\x1b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 1 unused configuration paths:\n- models.staging\n\x1b[0m14:33:56  Found 8 models, 12 data tests, 3 sources, 415 macros\n\x1b[0m14:33:56  \n\x1b[0m14:33:57  Concurrency: 4 threads (target=\'dev\')\n\x1b[0m14:33:57  \n\x1b[0m14:33:57  1 of 4 START sql view model staging.historic_raw ............................... [RUN]\n\x1b[0m14:33:57  1 of 4 OK created sql view model staging.historic_raw .......................... [\x1b[32mCREATE VIEW\x1b[0m in 0.10s]\n\x1b[0m14:33:57  2 of 4 START sql view model staging.historic_cleaned ........................... [RUN]\n\x1b[0m14:33:57  2 of 4 OK created sql view model staging.historic_cleaned ...................... [\x1b[32mCREATE VIEW\x1b[0m in 0.08s]\n\x1b[0m14:33:57  3 of 4 START sql view model staging.historic_renamed ........................... [RUN]\n\x1b[0m14:33:57  3 of 4 OK created sql view model staging.historic_renamed ...................... [\x1b[32mCREATE VIEW\x1b[0m in 0.04s]\n\x1b[0m14:33:57  4 of 4 START sql table model staging.historic_transformed ...................... [RUN]\n\x1b[0m14:33:57  4 of 4 ERROR creating sql table model staging.historic_transformed ............. [\x1b[31mERROR\x1b[0m in 0.08s]\n\x1b[0m14:33:57  \n\x1b[0m14:33:57  Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).\n\x1b[0m14:33:57  \n\x1b[0m14:33:57  \x1b[31mCompleted with 1 error and 0 warnings:\x1b[0m\n\x1b[0m14:33:57  \n\x1b[0m14:33:57    Database Error in model historic_transformed (models/staging/historic_transformed.sql)\n  invalid input syntax for integer: "NI"\n  compiled Code at target/run/adm_cgu_terceirizados/models/staging/historic_transformed.sql\n\x1b[0m14:33:57  \n\x1b[0m14:33:57  Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4\n', stderr='')
[2024-07-26 11:33:58,524] INFO - prefect.TaskRunner | FAIL signal raised: FAIL(None)
[2024-07-26 11:33:58,528] INFO - prefect.TaskRunner | Task 'run_dbt': Finished task run for task with final state: 'Failed'
[2024-07-26 11:33:58,534] INFO - prefect.TaskRunner | Task 'upload_logs_to_database': Starting task run...
[2024-07-26 11:33:58,538] INFO - prefect.upload_logs_to_database | 
 <> Conectado com PostgreSQL com sucesso!
[2024-07-26 11:33:58,539] INFO - prefect.upload_logs_to_database | 
 <> Tabela de logs logs__historic_materialize criada no PostgreSQL com sucesso!
[2024-07-26 11:33:58,540] INFO - prefect.upload_logs_to_database | 
 <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <>  <> 
[2024-07-26 11:33:58,549] INFO - prefect.upload_logs_to_database | 
 <> Dados de logs do Flow inseridos em logs__historic_materialize com sucesso!
[2024-07-26 11:33:58,549] INFO - prefect.upload_logs_to_database | 
 <> Feito upload do arquivo de log local logs/logs__historic_materialize.txt na tabela logs__historic_materialize PostgreSQL com sucesso!
[2024-07-26 11:33:58,552] INFO - prefect.TaskRunner | Task 'upload_logs_to_database': Finished task run for task with final state: 'Success'
[2024-07-26 11:33:58,552] INFO - prefect.FlowRunner | Flow run SUCCESS: all reference tasks succeeded
